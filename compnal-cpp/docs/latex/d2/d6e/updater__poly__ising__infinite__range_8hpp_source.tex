\hypertarget{updater__poly__ising__infinite__range_8hpp_source}{}\doxysection{updater\+\_\+poly\+\_\+ising\+\_\+infinite\+\_\+range.\+hpp}
\label{updater__poly__ising__infinite__range_8hpp_source}\index{src/solver/classical\_monte\_carlo\_updater/updater\_poly\_ising\_infinite\_range.hpp@{src/solver/classical\_monte\_carlo\_updater/updater\_poly\_ising\_infinite\_range.hpp}}
\mbox{\hyperlink{updater__poly__ising__infinite__range_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2022/07/17.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SOLVER\_UPDATER\_POLY\_ISING\_INFINITE\_RANGE\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SOLVER\_UPDATER\_POLY\_ISING\_INFINITE\_RANGE\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../../model/polynomial\_ising.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{25 \textcolor{keyword}{namespace }solver \{}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{template}<\textcolor{keyword}{typename} SpinType, \textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{28 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1solver_a681505518184b30354157e4694d5ae04}{ResetEnergyDifferenceInfiniteRange}}(std::vector<RealType> *energy\_difference,}
\DoxyCodeLine{29                                         std::vector<int> *system\_size\_index\_list,}
\DoxyCodeLine{30                                         \textcolor{keyword}{const} std::vector<SpinType> \&sample,}
\DoxyCodeLine{31                                         \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_polynomial_ising}{model::PolynomialIsing<RealType>}} \&model) \{}
\DoxyCodeLine{32    }
\DoxyCodeLine{33    \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(sample.size()) != model.GetSystemSize()) \{}
\DoxyCodeLine{34       \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}The sample size is not equal to the system size."{}});}
\DoxyCodeLine{35    \}}
\DoxyCodeLine{36    }
\DoxyCodeLine{37    \textcolor{keyword}{const} \textcolor{keywordtype}{int} system\_size = model.GetSystemSize();}
\DoxyCodeLine{38    \textcolor{keyword}{const} \textcolor{keyword}{auto} \&interaction = model.\mbox{\hyperlink{classcompnal_1_1model_1_1_polynomial_ising_ab2e348aba9a640491ff5536c3563e0c0}{GetInteraction}}();}
\DoxyCodeLine{39    energy\_difference-\/>clear();}
\DoxyCodeLine{40    energy\_difference-\/>resize(system\_size);}
\DoxyCodeLine{41    }
\DoxyCodeLine{42    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} index = 0; index < system\_size; ++index) \{}
\DoxyCodeLine{43       RealType val = 0.0;}
\DoxyCodeLine{44       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} target\_spin = sample[index];}
\DoxyCodeLine{45       }
\DoxyCodeLine{46       \textcolor{comment}{// Erase index in seed.}}
\DoxyCodeLine{47       std::swap((*system\_size\_index\_list)[index], (*system\_size\_index\_list).back());}
\DoxyCodeLine{48       }
\DoxyCodeLine{49       \textcolor{keywordflow}{if} (interaction.size() >= 1) \{}
\DoxyCodeLine{50          val += interaction[0]*sample[index];}
\DoxyCodeLine{51       \}}
\DoxyCodeLine{52       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 1; p < static\_cast<int>(interaction.size()); ++p) \{}
\DoxyCodeLine{53          \textcolor{keywordflow}{if} (std::abs(interaction[p]) > std::numeric\_limits<RealType>::epsilon()) \{}
\DoxyCodeLine{54             \textcolor{keyword}{const} RealType target\_ineraction = interaction[p];}
\DoxyCodeLine{55             }
\DoxyCodeLine{56             std::vector<int> indices(p);}
\DoxyCodeLine{57             \textcolor{keywordtype}{int} start\_index = 0;}
\DoxyCodeLine{58             \textcolor{keywordtype}{int} size = 0;}
\DoxyCodeLine{59             }
\DoxyCodeLine{60             \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{}
\DoxyCodeLine{61                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = start\_index; i < system\_size -\/ 1; ++i) \{}
\DoxyCodeLine{62                   indices[size++] = i;}
\DoxyCodeLine{63                   \textcolor{keywordflow}{if} (size == p) \{}
\DoxyCodeLine{64                      \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} sign = 1;}
\DoxyCodeLine{65                      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < p; ++j) \{}
\DoxyCodeLine{66                         sign *= sample[(*system\_size\_index\_list)[indices[j]]];}
\DoxyCodeLine{67                      \}}
\DoxyCodeLine{68                      val += target\_ineraction*sign*target\_spin;}
\DoxyCodeLine{69                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{70                   \}}
\DoxyCodeLine{71                \}}
\DoxyCodeLine{72                -\/-\/size;}
\DoxyCodeLine{73                \textcolor{keywordflow}{if} (size < 0) \{}
\DoxyCodeLine{74                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{75                \}}
\DoxyCodeLine{76                start\_index = indices[size] + 1;}
\DoxyCodeLine{77             \}}
\DoxyCodeLine{78             }
\DoxyCodeLine{79          \}}
\DoxyCodeLine{80       \}}
\DoxyCodeLine{81       (*energy\_difference)[index] = -\/2.0*val;}
\DoxyCodeLine{82       }
\DoxyCodeLine{83       \textcolor{comment}{// Restore index to seed.}}
\DoxyCodeLine{84       std::swap((*system\_size\_index\_list)[index], (*system\_size\_index\_list).back());}
\DoxyCodeLine{85    \}}
\DoxyCodeLine{86    }
\DoxyCodeLine{87 \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{keyword}{template}<\textcolor{keyword}{typename} SpinType, \textcolor{keyword}{typename} RealType>}
\DoxyCodeLine{90 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1solver_a725f8031b3bf7bae3e2537b76971ad0b}{UpdaterInfiniteRange}}(std::vector<SpinType> *sample,}
\DoxyCodeLine{91                           std::vector<RealType> *energy\_difference,}
\DoxyCodeLine{92                           std::vector<int> *system\_size\_index\_list,}
\DoxyCodeLine{93                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} index,}
\DoxyCodeLine{94                           \textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1model_1_1_polynomial_ising}{model::PolynomialIsing<RealType>}} \&model) \{}
\DoxyCodeLine{95    }
\DoxyCodeLine{96    \textcolor{keyword}{const} \textcolor{keywordtype}{int} num\_roop = model.GetSystemSize() -\/ 1;}
\DoxyCodeLine{97    \textcolor{keyword}{const} \textcolor{keyword}{auto} \&interaction = model.\mbox{\hyperlink{classcompnal_1_1model_1_1_polynomial_ising_ab2e348aba9a640491ff5536c3563e0c0}{GetInteraction}}();}
\DoxyCodeLine{98    \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} target\_spin = (*sample)[index];}
\DoxyCodeLine{99    }
\DoxyCodeLine{100    std::swap((*system\_size\_index\_list)[index], (*system\_size\_index\_list).back());}
\DoxyCodeLine{101    system\_size\_index\_list-\/>pop\_back();}
\DoxyCodeLine{102    }
\DoxyCodeLine{103    \textcolor{keywordflow}{if} (interaction.size() == 2) \{}
\DoxyCodeLine{104       \textcolor{keyword}{const} RealType target\_ineraction\_deg2 = interaction[1];}
\DoxyCodeLine{105       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i2 = 0; i2 < num\_roop; ++i2) \{}
\DoxyCodeLine{106          \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i2 = (*system\_size\_index\_list)[i2];}
\DoxyCodeLine{107          (*energy\_difference)[index\_i2] += 4*target\_ineraction\_deg2*target\_spin*(*sample)[index\_i2];}
\DoxyCodeLine{108       \}}
\DoxyCodeLine{109    \}}
\DoxyCodeLine{110    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (interaction.size() == 3) \{}
\DoxyCodeLine{111       \textcolor{keyword}{const} RealType target\_ineraction\_deg2 = interaction[1];}
\DoxyCodeLine{112       \textcolor{keyword}{const} RealType target\_ineraction\_deg3 = interaction[2];}
\DoxyCodeLine{113       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod1 = target\_spin;}
\DoxyCodeLine{114       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i2 = 0; i2 < num\_roop; ++i2) \{}
\DoxyCodeLine{115          \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i2 = (*system\_size\_index\_list)[i2];}
\DoxyCodeLine{116          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod2 = spin\_prod1*(*sample)[index\_i2];}
\DoxyCodeLine{117          \textcolor{keyword}{const} RealType diff\_val\_i2 = 4*target\_ineraction\_deg2*spin\_prod2;}
\DoxyCodeLine{118          RealType sum\_val\_i2 = 0;}
\DoxyCodeLine{119          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i3 = i2 + 1; i3 < num\_roop; ++i3) \{}
\DoxyCodeLine{120             \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i3 = (*system\_size\_index\_list)[i3];}
\DoxyCodeLine{121             \textcolor{keyword}{const} RealType diff\_val\_i3 = 4*target\_ineraction\_deg3*spin\_prod2*(*sample)[index\_i3];}
\DoxyCodeLine{122             (*energy\_difference)[index\_i3] += diff\_val\_i3;}
\DoxyCodeLine{123             sum\_val\_i2 += diff\_val\_i3;}
\DoxyCodeLine{124          \}}
\DoxyCodeLine{125          (*energy\_difference)[index\_i2] += sum\_val\_i2 + diff\_val\_i2;}
\DoxyCodeLine{126       \}}
\DoxyCodeLine{127    \}}
\DoxyCodeLine{128    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (interaction.size() == 4) \{}
\DoxyCodeLine{129       \textcolor{keyword}{const} RealType target\_ineraction\_deg2 = interaction[1];}
\DoxyCodeLine{130       \textcolor{keyword}{const} RealType target\_ineraction\_deg3 = interaction[2];}
\DoxyCodeLine{131       \textcolor{keyword}{const} RealType target\_ineraction\_deg4 = interaction[3];}
\DoxyCodeLine{132       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod1 = target\_spin;}
\DoxyCodeLine{133       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i2 = 0; i2 < num\_roop; ++i2) \{}
\DoxyCodeLine{134          \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i2 = (*system\_size\_index\_list)[i2];}
\DoxyCodeLine{135          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod2 = spin\_prod1*(*sample)[index\_i2];}
\DoxyCodeLine{136          \textcolor{keyword}{const} RealType diff\_val\_i2 = 4*target\_ineraction\_deg2*spin\_prod2;}
\DoxyCodeLine{137          RealType sum\_val\_i2 = 0;}
\DoxyCodeLine{138          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i3 = i2 + 1; i3 < num\_roop; ++i3) \{}
\DoxyCodeLine{139             \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i3 = (*system\_size\_index\_list)[i3];}
\DoxyCodeLine{140             \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod3 = spin\_prod2*(*sample)[index\_i3];}
\DoxyCodeLine{141             \textcolor{keyword}{const} RealType diff\_val\_i3 = 4*target\_ineraction\_deg3*spin\_prod3;}
\DoxyCodeLine{142             RealType sum\_val\_i3 = 0;}
\DoxyCodeLine{143             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i4 = i3 + 1; i4 < num\_roop; ++i4) \{}
\DoxyCodeLine{144                \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i4 = (*system\_size\_index\_list)[i4];}
\DoxyCodeLine{145                \textcolor{keyword}{const} RealType diff\_val\_i4 = 4*target\_ineraction\_deg4*spin\_prod3*(*sample)[index\_i4];}
\DoxyCodeLine{146                (*energy\_difference)[index\_i4] += diff\_val\_i4;}
\DoxyCodeLine{147                sum\_val\_i3 += diff\_val\_i4;}
\DoxyCodeLine{148             \}}
\DoxyCodeLine{149             (*energy\_difference)[index\_i3] += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{150             sum\_val\_i2 += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{151          \}}
\DoxyCodeLine{152          (*energy\_difference)[index\_i2] += sum\_val\_i2 + diff\_val\_i2;}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154    \}}
\DoxyCodeLine{155    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (interaction.size() == 5) \{}
\DoxyCodeLine{156       \textcolor{keyword}{const} RealType target\_ineraction\_deg2 = interaction[1];}
\DoxyCodeLine{157       \textcolor{keyword}{const} RealType target\_ineraction\_deg3 = interaction[2];}
\DoxyCodeLine{158       \textcolor{keyword}{const} RealType target\_ineraction\_deg4 = interaction[3];}
\DoxyCodeLine{159       \textcolor{keyword}{const} RealType target\_ineraction\_deg5 = interaction[4];}
\DoxyCodeLine{160       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod1 = target\_spin;}
\DoxyCodeLine{161       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i2 = 0; i2 < num\_roop; ++i2) \{}
\DoxyCodeLine{162          \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i2 = (*system\_size\_index\_list)[i2];}
\DoxyCodeLine{163          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod2 = spin\_prod1*(*sample)[index\_i2];}
\DoxyCodeLine{164          \textcolor{keyword}{const} RealType diff\_val\_i2 = 4*target\_ineraction\_deg2*spin\_prod2;}
\DoxyCodeLine{165          RealType sum\_val\_i2 = 0;}
\DoxyCodeLine{166          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i3 = i2 + 1; i3 < num\_roop; ++i3) \{}
\DoxyCodeLine{167             \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i3 = (*system\_size\_index\_list)[i3];}
\DoxyCodeLine{168             \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod3 = spin\_prod2*(*sample)[index\_i3];}
\DoxyCodeLine{169             \textcolor{keyword}{const} RealType diff\_val\_i3 = 4*target\_ineraction\_deg3*spin\_prod3;}
\DoxyCodeLine{170             RealType sum\_val\_i3 = 0;}
\DoxyCodeLine{171             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i4 = i3 + 1; i4 < num\_roop; ++i4) \{}
\DoxyCodeLine{172                \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i4 = (*system\_size\_index\_list)[i4];}
\DoxyCodeLine{173                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod4 = spin\_prod3*(*sample)[index\_i4];}
\DoxyCodeLine{174                \textcolor{keyword}{const} RealType diff\_val\_i4 = 4*target\_ineraction\_deg4*spin\_prod4;}
\DoxyCodeLine{175                RealType sum\_val\_i4 = 0;}
\DoxyCodeLine{176                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i5 = i4 + 1; i5 < num\_roop; ++i5) \{}
\DoxyCodeLine{177                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i5 = (*system\_size\_index\_list)[i5];}
\DoxyCodeLine{178                   \textcolor{keyword}{const} RealType diff\_val\_i5 = 4*target\_ineraction\_deg5*spin\_prod4*(*sample)[index\_i5];}
\DoxyCodeLine{179                   (*energy\_difference)[index\_i5] += diff\_val\_i5;}
\DoxyCodeLine{180                   sum\_val\_i4 += diff\_val\_i5;}
\DoxyCodeLine{181                \}}
\DoxyCodeLine{182                (*energy\_difference)[index\_i4] += sum\_val\_i4 + diff\_val\_i4;}
\DoxyCodeLine{183                sum\_val\_i3 += sum\_val\_i4 + diff\_val\_i4;}
\DoxyCodeLine{184             \}}
\DoxyCodeLine{185             (*energy\_difference)[index\_i3] += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{186             sum\_val\_i2 += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{187          \}}
\DoxyCodeLine{188          (*energy\_difference)[index\_i2] += sum\_val\_i2 + diff\_val\_i2;}
\DoxyCodeLine{189       \}}
\DoxyCodeLine{190    \}}
\DoxyCodeLine{191    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (interaction.size() == 6) \{}
\DoxyCodeLine{192       \textcolor{keyword}{const} RealType target\_ineraction\_deg2 = interaction[1];}
\DoxyCodeLine{193       \textcolor{keyword}{const} RealType target\_ineraction\_deg3 = interaction[2];}
\DoxyCodeLine{194       \textcolor{keyword}{const} RealType target\_ineraction\_deg4 = interaction[3];}
\DoxyCodeLine{195       \textcolor{keyword}{const} RealType target\_ineraction\_deg5 = interaction[4];}
\DoxyCodeLine{196       \textcolor{keyword}{const} RealType target\_ineraction\_deg6 = interaction[5];}
\DoxyCodeLine{197       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod1 = target\_spin;}
\DoxyCodeLine{198       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i2 = 0; i2 < num\_roop; ++i2) \{}
\DoxyCodeLine{199          \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i2 = (*system\_size\_index\_list)[i2];}
\DoxyCodeLine{200          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod2 = spin\_prod1*(*sample)[index\_i2];}
\DoxyCodeLine{201          \textcolor{keyword}{const} RealType diff\_val\_i2 = 4*target\_ineraction\_deg2*spin\_prod2;}
\DoxyCodeLine{202          RealType sum\_val\_i2 = 0;}
\DoxyCodeLine{203          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i3 = i2 + 1; i3 < num\_roop; ++i3) \{}
\DoxyCodeLine{204             \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i3 = (*system\_size\_index\_list)[i3];}
\DoxyCodeLine{205             \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod3 = spin\_prod2*(*sample)[index\_i3];}
\DoxyCodeLine{206             \textcolor{keyword}{const} RealType diff\_val\_i3 = 4*target\_ineraction\_deg3*spin\_prod3;}
\DoxyCodeLine{207             RealType sum\_val\_i3 = 0;}
\DoxyCodeLine{208             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i4 = i3 + 1; i4 < num\_roop; ++i4) \{}
\DoxyCodeLine{209                \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i4 = (*system\_size\_index\_list)[i4];}
\DoxyCodeLine{210                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod4 = spin\_prod3*(*sample)[index\_i4];}
\DoxyCodeLine{211                \textcolor{keyword}{const} RealType diff\_val\_i4 = 4*target\_ineraction\_deg4*spin\_prod4;}
\DoxyCodeLine{212                RealType sum\_val\_i4 = 0;}
\DoxyCodeLine{213                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i5 = i4 + 1; i5 < num\_roop; ++i5) \{}
\DoxyCodeLine{214                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i5 = (*system\_size\_index\_list)[i5];}
\DoxyCodeLine{215                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod5 = spin\_prod4*(*sample)[index\_i5];}
\DoxyCodeLine{216                   \textcolor{keyword}{const} RealType diff\_val\_i5 = 4*target\_ineraction\_deg5*spin\_prod5;}
\DoxyCodeLine{217                   RealType sum\_val\_i5 = 0;}
\DoxyCodeLine{218                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i6 = i5 + 1; i6 < num\_roop; ++i6) \{}
\DoxyCodeLine{219                      \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i6 = (*system\_size\_index\_list)[i6];}
\DoxyCodeLine{220                      \textcolor{keyword}{const} RealType diff\_val\_i6 = 4*target\_ineraction\_deg6*spin\_prod5*(*sample)[index\_i6];}
\DoxyCodeLine{221                      (*energy\_difference)[index\_i6] += diff\_val\_i6;}
\DoxyCodeLine{222                      sum\_val\_i5 += diff\_val\_i6;}
\DoxyCodeLine{223                   \}}
\DoxyCodeLine{224                   (*energy\_difference)[index\_i5] += sum\_val\_i5 + diff\_val\_i5;}
\DoxyCodeLine{225                   sum\_val\_i4 += sum\_val\_i5 + diff\_val\_i5;}
\DoxyCodeLine{226                \}}
\DoxyCodeLine{227                (*energy\_difference)[index\_i4] += sum\_val\_i4 + diff\_val\_i4;}
\DoxyCodeLine{228                sum\_val\_i3 += sum\_val\_i4 + diff\_val\_i4;}
\DoxyCodeLine{229             \}}
\DoxyCodeLine{230             (*energy\_difference)[index\_i3] += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{231             sum\_val\_i2 += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{232          \}}
\DoxyCodeLine{233          (*energy\_difference)[index\_i2] += sum\_val\_i2 + diff\_val\_i2;}
\DoxyCodeLine{234       \}}
\DoxyCodeLine{235    \}}
\DoxyCodeLine{236    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (interaction.size() == 7) \{}
\DoxyCodeLine{237       \textcolor{keyword}{const} RealType target\_ineraction\_deg2 = interaction[1];}
\DoxyCodeLine{238       \textcolor{keyword}{const} RealType target\_ineraction\_deg3 = interaction[2];}
\DoxyCodeLine{239       \textcolor{keyword}{const} RealType target\_ineraction\_deg4 = interaction[3];}
\DoxyCodeLine{240       \textcolor{keyword}{const} RealType target\_ineraction\_deg5 = interaction[4];}
\DoxyCodeLine{241       \textcolor{keyword}{const} RealType target\_ineraction\_deg6 = interaction[5];}
\DoxyCodeLine{242       \textcolor{keyword}{const} RealType target\_ineraction\_deg7 = interaction[6];}
\DoxyCodeLine{243       \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod1 = target\_spin;}
\DoxyCodeLine{244       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i2 = 0; i2 < num\_roop; ++i2) \{}
\DoxyCodeLine{245          \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i2 = (*system\_size\_index\_list)[i2];}
\DoxyCodeLine{246          \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod2 = spin\_prod1*(*sample)[index\_i2];}
\DoxyCodeLine{247          \textcolor{keyword}{const} RealType diff\_val\_i2 = 4*target\_ineraction\_deg2*spin\_prod2;}
\DoxyCodeLine{248          RealType sum\_val\_i2 = 0;}
\DoxyCodeLine{249          \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i3 = i2 + 1; i3 < num\_roop; ++i3) \{}
\DoxyCodeLine{250             \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i3 = (*system\_size\_index\_list)[i3];}
\DoxyCodeLine{251             \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod3 = spin\_prod2*(*sample)[index\_i3];}
\DoxyCodeLine{252             \textcolor{keyword}{const} RealType diff\_val\_i3 = 4*target\_ineraction\_deg3*spin\_prod3;}
\DoxyCodeLine{253             RealType sum\_val\_i3 = 0;}
\DoxyCodeLine{254             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i4 = i3 + 1; i4 < num\_roop; ++i4) \{}
\DoxyCodeLine{255                \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i4 = (*system\_size\_index\_list)[i4];}
\DoxyCodeLine{256                \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod4 = spin\_prod3*(*sample)[index\_i4];}
\DoxyCodeLine{257                \textcolor{keyword}{const} RealType diff\_val\_i4 = 4*target\_ineraction\_deg4*spin\_prod4;}
\DoxyCodeLine{258                RealType sum\_val\_i4 = 0;}
\DoxyCodeLine{259                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i5 = i4 + 1; i5 < num\_roop; ++i5) \{}
\DoxyCodeLine{260                   \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i5 = (*system\_size\_index\_list)[i5];}
\DoxyCodeLine{261                   \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod5 = spin\_prod4*(*sample)[index\_i5];}
\DoxyCodeLine{262                   \textcolor{keyword}{const} RealType diff\_val\_i5 = 4*target\_ineraction\_deg5*spin\_prod5;}
\DoxyCodeLine{263                   RealType sum\_val\_i5 = 0;}
\DoxyCodeLine{264                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i6 = i5 + 1; i6 < num\_roop; ++i6) \{}
\DoxyCodeLine{265                      \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i6 = (*system\_size\_index\_list)[i6];}
\DoxyCodeLine{266                      \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} spin\_prod6 = spin\_prod5*(*sample)[index\_i6];}
\DoxyCodeLine{267                      \textcolor{keyword}{const} RealType diff\_val\_i6 = 4*target\_ineraction\_deg6*spin\_prod6;}
\DoxyCodeLine{268                      RealType sum\_val\_i6 = 0;}
\DoxyCodeLine{269                      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i7 = i6 + 1; i7 < num\_roop; ++i7) \{}
\DoxyCodeLine{270                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} index\_i7 = (*system\_size\_index\_list)[i7];}
\DoxyCodeLine{271                         \textcolor{keyword}{const} RealType diff\_val\_i7 = 4*target\_ineraction\_deg7*spin\_prod6*(*sample)[index\_i7];}
\DoxyCodeLine{272                         (*energy\_difference)[index\_i7] += diff\_val\_i7;}
\DoxyCodeLine{273                         sum\_val\_i6 += diff\_val\_i7;}
\DoxyCodeLine{274                      \}}
\DoxyCodeLine{275                      (*energy\_difference)[index\_i6] += sum\_val\_i6 + diff\_val\_i6;}
\DoxyCodeLine{276                      sum\_val\_i5 += sum\_val\_i6 + diff\_val\_i6;}
\DoxyCodeLine{277                   \}}
\DoxyCodeLine{278                   (*energy\_difference)[index\_i5] += sum\_val\_i5 + diff\_val\_i5;}
\DoxyCodeLine{279                   sum\_val\_i4 += sum\_val\_i5 + diff\_val\_i5;}
\DoxyCodeLine{280                \}}
\DoxyCodeLine{281                (*energy\_difference)[index\_i4] += sum\_val\_i4 + diff\_val\_i4;}
\DoxyCodeLine{282                sum\_val\_i3 += sum\_val\_i4 + diff\_val\_i4;}
\DoxyCodeLine{283             \}}
\DoxyCodeLine{284             (*energy\_difference)[index\_i3] += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{285             sum\_val\_i2 += sum\_val\_i3 + diff\_val\_i3;}
\DoxyCodeLine{286          \}}
\DoxyCodeLine{287          (*energy\_difference)[index\_i2] += sum\_val\_i2 + diff\_val\_i2;}
\DoxyCodeLine{288       \}}
\DoxyCodeLine{289    \}}
\DoxyCodeLine{290    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{291       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 1; p < static\_cast<int>(interaction.size()); ++p) \{}
\DoxyCodeLine{292          \textcolor{keywordflow}{if} (std::abs(interaction[p]) > std::numeric\_limits<RealType>::epsilon()) \{}
\DoxyCodeLine{293             \textcolor{keyword}{const} RealType target\_ineraction = interaction[p];}
\DoxyCodeLine{294             std::vector<int> indices(p);}
\DoxyCodeLine{295             \textcolor{keywordtype}{int} start\_index = 0;}
\DoxyCodeLine{296             \textcolor{keywordtype}{int} size = 0;}
\DoxyCodeLine{297             \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{}
\DoxyCodeLine{298                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = start\_index; i < num\_roop; ++i) \{}
\DoxyCodeLine{299                   indices[size++] = i;}
\DoxyCodeLine{300                   \textcolor{keywordflow}{if} (size == p) \{}
\DoxyCodeLine{301                      \mbox{\hyperlink{namespacecompnal_1_1utility_adf56729501e19b42db8e7997131884c8}{SpinType}} sign = 1;}
\DoxyCodeLine{302                      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < p; ++j) \{}
\DoxyCodeLine{303                         sign *= (*sample)[(*system\_size\_index\_list)[indices[j]]];}
\DoxyCodeLine{304                      \}}
\DoxyCodeLine{305                      \textcolor{keyword}{const} RealType val = 4*target\_spin*sign*target\_ineraction;}
\DoxyCodeLine{306                      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < p; ++j) \{}
\DoxyCodeLine{307                         (*energy\_difference)[(*system\_size\_index\_list)[indices[j]]] += val;}
\DoxyCodeLine{308                      \}}
\DoxyCodeLine{309                      \textcolor{keywordflow}{break};}
\DoxyCodeLine{310                   \}}
\DoxyCodeLine{311                \}}
\DoxyCodeLine{312                -\/-\/size;}
\DoxyCodeLine{313                \textcolor{keywordflow}{if} (size < 0) \{}
\DoxyCodeLine{314                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{315                \}}
\DoxyCodeLine{316                start\_index = indices[size] + 1;}
\DoxyCodeLine{317             \}}
\DoxyCodeLine{318          \}}
\DoxyCodeLine{319       \}}
\DoxyCodeLine{320    \}}
\DoxyCodeLine{321    (*energy\_difference)[index] *= -\/1;}
\DoxyCodeLine{322    (*sample)[index] *= -\/1;}
\DoxyCodeLine{323    system\_size\_index\_list-\/>push\_back(index);}
\DoxyCodeLine{324    std::swap((*system\_size\_index\_list)[index], (*system\_size\_index\_list).back());}
\DoxyCodeLine{325 \}}
\DoxyCodeLine{326 }
\DoxyCodeLine{327 }
\DoxyCodeLine{328 \} \textcolor{comment}{// namespace solver}}
\DoxyCodeLine{329 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SOLVER\_UPDATER\_POLY\_ISING\_INFINITE\_RANGE\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
