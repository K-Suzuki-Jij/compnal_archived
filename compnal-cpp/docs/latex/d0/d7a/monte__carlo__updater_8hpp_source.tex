\hypertarget{monte__carlo__updater_8hpp_source}{}\doxysection{monte\+\_\+carlo\+\_\+updater.\+hpp}
\label{monte__carlo__updater_8hpp_source}\index{src/solver/updater/monte\_carlo\_updater.hpp@{src/solver/updater/monte\_carlo\_updater.hpp}}
\mbox{\hyperlink{monte__carlo__updater_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//}}
\DoxyCodeLine{2 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{//}}
\DoxyCodeLine{8 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{9 \textcolor{comment}{//}}
\DoxyCodeLine{10 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{11 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{12 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{13 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{14 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{15 \textcolor{comment}{//}}
\DoxyCodeLine{16 \textcolor{comment}{//  monte\_carlo\_updater.hpp}}
\DoxyCodeLine{17 \textcolor{comment}{//  compnal}}
\DoxyCodeLine{18 \textcolor{comment}{//}}
\DoxyCodeLine{19 \textcolor{comment}{//  Created by kohei on 2022/08/13.}}
\DoxyCodeLine{20 \textcolor{comment}{//  }}
\DoxyCodeLine{21 \textcolor{comment}{//}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#ifndef COMPNAL\_SOLVER\_UPDATER\_MONTE\_CARLO\_UPDATER\_HPP\_}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define COMPNAL\_SOLVER\_UPDATER\_MONTE\_CARLO\_UPDATER\_HPP\_}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{ssf__polynomial__ising__infinite__range_8hpp}{ssf\_polynomial\_ising\_infinite\_range.hpp}}"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}../../utility/type.hpp"{}}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{30 \textcolor{keyword}{namespace }solver \{}
\DoxyCodeLine{31 \textcolor{keyword}{namespace }updater \{}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealType, \textcolor{keyword}{class} ModelType>}
\DoxyCodeLine{34 \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecompnal_1_1solver_1_1updater_a412f4848a6dd34fbb679354e7f23679d}{ExecuteMetropolis}}(std::vector<utility::SpinType> *sample,}
\DoxyCodeLine{35                        \textcolor{keyword}{const} ModelType \&model,}
\DoxyCodeLine{36                        \textcolor{keyword}{const} std::int32\_t num\_sweeps,}
\DoxyCodeLine{37                        \textcolor{keyword}{const} RealType beta,}
\DoxyCodeLine{38                        \textcolor{keyword}{const} std::uint64\_t seed) \{}
\DoxyCodeLine{39    }
\DoxyCodeLine{40    \textcolor{comment}{//using RealType = typename ModelType::ValueType;}}
\DoxyCodeLine{41    }
\DoxyCodeLine{42    \textcolor{keywordflow}{if} (sample-\/>size() != \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(model.GetSystemSize())) \{}
\DoxyCodeLine{43       \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}The sample size is not equal to the system size."{}});}
\DoxyCodeLine{44    \}}
\DoxyCodeLine{45    }
\DoxyCodeLine{46    \textcolor{keyword}{const} std::int32\_t system\_size = model.GetSystemSize();}
\DoxyCodeLine{47    }
\DoxyCodeLine{48    \textcolor{comment}{// Set random number engine}}
\DoxyCodeLine{49    \mbox{\hyperlink{namespacecompnal_1_1utility_a16654fac778ada1d5434540168b09f26}{utility::RandType}} random\_number\_engine(seed);}
\DoxyCodeLine{50    std::uniform\_real\_distribution<RealType> dist\_real(0, 1);}
\DoxyCodeLine{51    std::uniform\_int\_distribution<std::int32\_t> dist\_system\_size(0, system\_size -\/ 1);}
\DoxyCodeLine{52    }
\DoxyCodeLine{53    \textcolor{comment}{// Prepare system size index list (0, 1, 2, ..., N -\/ 1)}}
\DoxyCodeLine{54    std::vector<std::int32\_t> system\_size\_index\_list(system\_size);}
\DoxyCodeLine{55    std::iota(system\_size\_index\_list.begin(), system\_size\_index\_list.end(), 0);}
\DoxyCodeLine{56    }
\DoxyCodeLine{57    \textcolor{comment}{// Set energy difference}}
\DoxyCodeLine{58    std::vector<RealType> energy\_difference(system\_size);}
\DoxyCodeLine{59    SetEnergyDifference<RealType>(\&energy\_difference, \&system\_size\_index\_list, *sample, model);}
\DoxyCodeLine{60    }
\DoxyCodeLine{61    \textcolor{keywordflow}{for} (std::int32\_t sweep\_count = 0; sweep\_count < num\_sweeps; sweep\_count++) \{}
\DoxyCodeLine{62       \textcolor{keywordflow}{for} (std::int32\_t i = 0; i < system\_size; i++) \{}
\DoxyCodeLine{63          \textcolor{keyword}{const} std::int32\_t index = dist\_system\_size(random\_number\_engine);}
\DoxyCodeLine{64          \textcolor{keywordflow}{if} (energy\_difference[index] <= 0.0 || std::exp(-\/beta*energy\_difference[index]) > dist\_real(random\_number\_engine)) \{}
\DoxyCodeLine{65             \mbox{\hyperlink{namespacecompnal_1_1solver_1_1updater_a3732d6ddc5c0a50490c8cd1f24307543}{UpdateConfiguration}}(sample, \&energy\_difference, \&system\_size\_index\_list, index, model);}
\DoxyCodeLine{66          \}}
\DoxyCodeLine{67       \}}
\DoxyCodeLine{68    \}}
\DoxyCodeLine{69 \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \} \textcolor{comment}{// namespace updater}}
\DoxyCodeLine{72 \} \textcolor{comment}{// namespace solver}}
\DoxyCodeLine{73 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_MODEL\_MONTE\_CARLO\_UPDATER\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
