\hypertarget{classical__monte__carlo_8hpp_source}{}\doxysection{classical\+\_\+monte\+\_\+carlo.\+hpp}
\label{classical__monte__carlo_8hpp_source}\index{src/solver/classical\_monte\_carlo.hpp@{src/solver/classical\_monte\_carlo.hpp}}
\mbox{\hyperlink{classical__monte__carlo_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//  Copyright 2022 Kohei Suzuki}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{//  Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{4 \textcolor{comment}{//  you may not use this file except in compliance with the License.}}
\DoxyCodeLine{5 \textcolor{comment}{//  You may obtain a copy of the License at}}
\DoxyCodeLine{6 \textcolor{comment}{//}}
\DoxyCodeLine{7 \textcolor{comment}{//      http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{//}}
\DoxyCodeLine{9 \textcolor{comment}{//  Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{//  distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{//  See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{//  limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{//}}
\DoxyCodeLine{15 \textcolor{comment}{//  Created by Kohei Suzuki on 2022/06/11.}}
\DoxyCodeLine{16 \textcolor{comment}{//}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMPNAL\_SOLVER\_CLASSICAL\_MONTE\_CARLO\_HPP\_}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMPNAL\_SOLVER\_CLASSICAL\_MONTE\_CARLO\_HPP\_}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}../utility/type.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{monte__carlo__updater_8hpp}{updater/monte\_carlo\_updater.hpp}}"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <random>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecompnal}{compnal}} \{}
\DoxyCodeLine{28 \textcolor{keyword}{namespace }solver \{}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{enum class} \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13d}{CMCUpdater}} \{}
\DoxyCodeLine{31    }
\DoxyCodeLine{32    \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13da927bbbfc6e23f42b7a6d80edade77733}{METROPOLIS}},}
\DoxyCodeLine{33    \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13da52186bba0a3e7af22a70ebb93de1b146}{HEAT\_BATH}}}
\DoxyCodeLine{34    }
\DoxyCodeLine{35 \};}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{keyword}{template}<\textcolor{keyword}{class} ModelType>}
\DoxyCodeLine{38 \textcolor{keyword}{class }\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo}{ClassicalMonteCarlo}} \{}
\DoxyCodeLine{39    }
\DoxyCodeLine{40    \textcolor{keyword}{using }\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} = \textcolor{keyword}{typename} ModelType::ValueType;}
\DoxyCodeLine{41    \textcolor{keyword}{using }\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a3176ff90b02ce4b5f0441b5ce2bf260f}{OPType}} = \textcolor{keyword}{typename} ModelType::OPType;}
\DoxyCodeLine{42    }
\DoxyCodeLine{43 \textcolor{keyword}{public}:}
\DoxyCodeLine{44    }
\DoxyCodeLine{45    \textcolor{keyword}{const} ModelType \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}};}
\DoxyCodeLine{46    \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13d}{CMCUpdater}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a53a5d1760c9946ceb166cf89f5b9ca8b}{cmc\_updater}};}
\DoxyCodeLine{47    }
\DoxyCodeLine{48    \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a3d84d6177e9a385d229c65565021ab9a}{ClassicalMonteCarlo}}(\textcolor{keyword}{const} ModelType \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}, \textcolor{keyword}{const} \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13d}{CMCUpdater}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a53a5d1760c9946ceb166cf89f5b9ca8b}{cmc\_updater}}): \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}), \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a53a5d1760c9946ceb166cf89f5b9ca8b}{cmc\_updater}}(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a53a5d1760c9946ceb166cf89f5b9ca8b}{cmc\_updater}}) \{\}}
\DoxyCodeLine{49    }
\DoxyCodeLine{50    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a61001d8d385c113f582d130483dff759}{SetNumSweeps}}(\textcolor{keyword}{const} std::int32\_t num\_sweeps) \{}
\DoxyCodeLine{51       \textcolor{keywordflow}{if} (num\_sweeps < 0) \{}
\DoxyCodeLine{52          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}num\_sweeps must be non-\/negative integer."{}});}
\DoxyCodeLine{53       \}}
\DoxyCodeLine{54       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a839b71d9083c74c58565f1a78b32295e}{num\_sweeps\_}} = num\_sweeps;}
\DoxyCodeLine{55    \}}
\DoxyCodeLine{56    }
\DoxyCodeLine{57    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af3437a1da8ccc14ea723ba70f340a368}{SetNumSamples}}(\textcolor{keyword}{const} std::int32\_t num\_samples) \{}
\DoxyCodeLine{58       \textcolor{keywordflow}{if} (num\_samples < 0) \{}
\DoxyCodeLine{59          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}num\_samples must be non-\/negative integer."{}});}
\DoxyCodeLine{60       \}}
\DoxyCodeLine{61       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}} = num\_samples;}
\DoxyCodeLine{62    \}}
\DoxyCodeLine{63    }
\DoxyCodeLine{64    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a35894ae003e3e522d7e023f96ff3bbe6}{SetTemperature}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} temperature) \{}
\DoxyCodeLine{65       \textcolor{keywordflow}{if} (temperature <= 0) \{}
\DoxyCodeLine{66          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Temperature must be positive number"{}});}
\DoxyCodeLine{67       \}}
\DoxyCodeLine{68       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af90061ac0e76a3b879725cddc4fecd54}{beta\_}} = 1/temperature;}
\DoxyCodeLine{69    \}}
\DoxyCodeLine{70    }
\DoxyCodeLine{71    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a62a35af0704f2e4e10e9b219363a2c08}{SetInverseTemperature}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} beta) \{}
\DoxyCodeLine{72       \textcolor{keywordflow}{if} (beta < 0) \{}
\DoxyCodeLine{73          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Inverse temperature must be positive number"{}});}
\DoxyCodeLine{74       \}}
\DoxyCodeLine{75       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af90061ac0e76a3b879725cddc4fecd54}{beta\_}} = beta;}
\DoxyCodeLine{76    \}}
\DoxyCodeLine{77    }
\DoxyCodeLine{78    std::int32\_t \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a41a963e53c6efd72164fffe5d45ae986}{GetNumSweeps}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{79       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a839b71d9083c74c58565f1a78b32295e}{num\_sweeps\_}};}
\DoxyCodeLine{80    \}}
\DoxyCodeLine{81    }
\DoxyCodeLine{82    std::int32\_t \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ac8b7afc5ce9b11e9030195e09a4d375b}{GetNumSamples}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{83       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}};}
\DoxyCodeLine{84    \}}
\DoxyCodeLine{85    }
\DoxyCodeLine{86    \textcolor{keyword}{const} std::vector<std::vector<OPType>> \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a153e2cbbf4c57083f0349f5394ba94d0}{GetSamples}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{87       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}};}
\DoxyCodeLine{88    \}}
\DoxyCodeLine{89    }
\DoxyCodeLine{90    \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a547418ec2167d5eeaf13d7547117ac09}{GetTemperature}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{91       \textcolor{keywordflow}{return} 1/\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af90061ac0e76a3b879725cddc4fecd54}{beta\_}};}
\DoxyCodeLine{92    \}}
\DoxyCodeLine{93    }
\DoxyCodeLine{94    \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af13e28fde540401ee88ab699b9edbfe6}{GetInverseTemperature}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{95       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af90061ac0e76a3b879725cddc4fecd54}{beta\_}};}
\DoxyCodeLine{96    \}}
\DoxyCodeLine{97    }
\DoxyCodeLine{98    std::uint64\_t \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_afe66437580e6408209f5337d12c3f348}{GetSeed}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{99       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a6d8ce5753c342919e567107f89448d8d}{seed\_}};}
\DoxyCodeLine{100    \}}
\DoxyCodeLine{101    }
\DoxyCodeLine{102    \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{103    \textcolor{keyword}{const} std::vector<OPType> \&\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5413a56d2e8c02db236f6a8e4e121b8a}{GetSample}}(\textcolor{keyword}{const} T index)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{104       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}.at(index);}
\DoxyCodeLine{105    \}}
\DoxyCodeLine{106       }
\DoxyCodeLine{107    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a77b3ec419cd279341df43ddf04df628c}{Run}}() \{}
\DoxyCodeLine{108       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a77b3ec419cd279341df43ddf04df628c}{Run}}(std::random\_device()());}
\DoxyCodeLine{109    \}}
\DoxyCodeLine{110    }
\DoxyCodeLine{111    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_aae393086da74fe3813f2d77db1ec7aa8}{Run}}(\textcolor{keyword}{const} std::uint64\_t seed) \{}
\DoxyCodeLine{112       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}} < 0) \{}
\DoxyCodeLine{113          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}num\_samples must be non-\/negative integer."{}});}
\DoxyCodeLine{114       \}}
\DoxyCodeLine{115       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a839b71d9083c74c58565f1a78b32295e}{num\_sweeps\_}} < 0) \{}
\DoxyCodeLine{116          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}num\_sweeps must be non-\/negative integer."{}});}
\DoxyCodeLine{117       \}}
\DoxyCodeLine{118       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a6d8ce5753c342919e567107f89448d8d}{seed\_}} = seed;}
\DoxyCodeLine{119       }
\DoxyCodeLine{120       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}.resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}});}
\DoxyCodeLine{121       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}.size(); ++i) \{}
\DoxyCodeLine{122          \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}[i].resize(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}.GetSystemSize());}
\DoxyCodeLine{123       \}}
\DoxyCodeLine{124       \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}.shrink\_to\_fit();}
\DoxyCodeLine{125       }
\DoxyCodeLine{126       \mbox{\hyperlink{namespacecompnal_1_1utility_a16654fac778ada1d5434540168b09f26}{utility::RandType}} random\_number\_engine(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a6d8ce5753c342919e567107f89448d8d}{seed\_}});}
\DoxyCodeLine{127       std::vector<std::uint64\_t> configuration\_seed\_list(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}});}
\DoxyCodeLine{128       std::vector<std::uint64\_t> execute\_seed\_list(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}});}
\DoxyCodeLine{129 }
\DoxyCodeLine{130       \textcolor{keywordflow}{for} (int32\_t i = 0; i < \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}}; ++i) \{}
\DoxyCodeLine{131          configuration\_seed\_list[i] = random\_number\_engine();}
\DoxyCodeLine{132          execute\_seed\_list[i] = random\_number\_engine();}
\DoxyCodeLine{133       \}}
\DoxyCodeLine{134       }
\DoxyCodeLine{135       \textcolor{keywordflow}{if} (this-\/>cmc\_updater == \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13da927bbbfc6e23f42b7a6d80edade77733}{CMCUpdater::METROPOLIS}}) \{}
\DoxyCodeLine{136 \textcolor{preprocessor}{\#pragma omp parallel for schedule(guided)}}
\DoxyCodeLine{137          \textcolor{keywordflow}{for} (std::int32\_t sample\_count = 0; sample\_count < \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}}; sample\_count++) \{}
\DoxyCodeLine{138             \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a320fdf474c9e172a3fdcf07068369baf}{RandomizeConfiguration}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}[sample\_count], configuration\_seed\_list[sample\_count]);}
\DoxyCodeLine{139             \mbox{\hyperlink{namespacecompnal_1_1solver_1_1updater_a412f4848a6dd34fbb679354e7f23679d}{updater::ExecuteMetropolis}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}[sample\_count], \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a839b71d9083c74c58565f1a78b32295e}{num\_sweeps\_}}, \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af90061ac0e76a3b879725cddc4fecd54}{beta\_}}, execute\_seed\_list[sample\_count]);}
\DoxyCodeLine{140          \}}
\DoxyCodeLine{141       \}}
\DoxyCodeLine{142       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>cmc\_updater == \mbox{\hyperlink{namespacecompnal_1_1solver_a05ed20ddcf6c44882ed7ab9d3c31d13da52186bba0a3e7af22a70ebb93de1b146}{CMCUpdater::HEAT\_BATH}}) \{}
\DoxyCodeLine{143 \textcolor{preprocessor}{\#pragma omp parallel for schedule(guided)}}
\DoxyCodeLine{144          \textcolor{keywordflow}{for} (std::int32\_t sample\_count = 0; sample\_count < \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}}; sample\_count++) \{}
\DoxyCodeLine{145             \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a320fdf474c9e172a3fdcf07068369baf}{RandomizeConfiguration}}(\&\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}[sample\_count], configuration\_seed\_list[sample\_count]);}
\DoxyCodeLine{146             \textcolor{comment}{//updater::ExecuteHeatBath(\&samples\_[sample\_count], model, num\_sweeps\_, beta\_, execute\_seed\_list[sample\_count]);}}
\DoxyCodeLine{147          \}}
\DoxyCodeLine{148       \}}
\DoxyCodeLine{149       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{150          \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Unknown Updater"{}});}
\DoxyCodeLine{151       \}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153    \}}
\DoxyCodeLine{154    }
\DoxyCodeLine{155    \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a3ef573fcb8b6dae07e4783870ad99475}{CalculateSampleAverage}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{156       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}.CalculateAverage(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}});}
\DoxyCodeLine{157    \}}
\DoxyCodeLine{158    }
\DoxyCodeLine{159    \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a413f8b38f9c718cae25d2bc789be8c99}{CalculateSampleMoment}}(\textcolor{keyword}{const} std::int32\_t degree)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{160       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_add3cf9017dba4d5cdda0bcace954348c}{model}}.CalculateMoment(\mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}}, degree);}
\DoxyCodeLine{161    \}}
\DoxyCodeLine{162    }
\DoxyCodeLine{163 \textcolor{keyword}{private}:}
\DoxyCodeLine{164    std::int32\_t \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a839b71d9083c74c58565f1a78b32295e}{num\_sweeps\_}}  = 1000;}
\DoxyCodeLine{165    std::int32\_t \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a82b2d93c1c68d6f73f9425165f3d6018}{num\_samples\_}} = 1;}
\DoxyCodeLine{166    \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a5c7cad47b0751d8aab6642c424c00a05}{RealType}} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_af90061ac0e76a3b879725cddc4fecd54}{beta\_}}   = 1;}
\DoxyCodeLine{167    std::vector<std::vector<OPType>> \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_ae4d33dbb5990049ff83beaf9d33013dc}{samples\_}};}
\DoxyCodeLine{168    std::uint64\_t \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a6d8ce5753c342919e567107f89448d8d}{seed\_}} = 0;}
\DoxyCodeLine{169    }
\DoxyCodeLine{170    \textcolor{keywordtype}{void} \mbox{\hyperlink{classcompnal_1_1solver_1_1_classical_monte_carlo_a320fdf474c9e172a3fdcf07068369baf}{RandomizeConfiguration}}(std::vector<utility::SpinType> *sample,}
\DoxyCodeLine{171                                \textcolor{keyword}{const} std::uint64\_t seed)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{172       std::uniform\_int\_distribution<utility::SpinType> dist(0, 1);}
\DoxyCodeLine{173       \mbox{\hyperlink{namespacecompnal_1_1utility_a16654fac778ada1d5434540168b09f26}{utility::RandType}} random\_number\_engine(seed);}
\DoxyCodeLine{174       \textcolor{keywordflow}{for} (std::size\_t i = 0; i < sample-\/>size(); i++) \{}
\DoxyCodeLine{175          (*sample)[i] = 2*dist(random\_number\_engine) -\/ 1;}
\DoxyCodeLine{176       \}}
\DoxyCodeLine{177    \}}
\DoxyCodeLine{178    }
\DoxyCodeLine{179 \};}
\DoxyCodeLine{180 }
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \} \textcolor{comment}{// namespace solver}}
\DoxyCodeLine{183 \} \textcolor{comment}{// namespace compnal}}
\DoxyCodeLine{184 }
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* COMPNAL\_SOLVER\_CLASSICAL\_MONTE\_CARLO\_HPP\_ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
